model:
  _target_: src.basic_lvl3.TransferLearningModule
  backbone:
    _target_: torchvision.models.resnet50
    weights: DEFAULT
  classification_head:
    _target_: torch.nn.Sequential
    _args_:
      - _target_: torch.nn.BatchNorm1d
        num_features: 2048
      - _target_: torch.nn.Linear
        in_features: 2048
        out_features: 512
      - _target_: torch.nn.ReLU
      - _target_: torch.nn.BatchNorm1d
        num_features: 512
      - _target_: torch.nn.Linear
        in_features: 512
        out_features: 256
      - _target_: torch.nn.ReLU
      - _target_: torch.nn.Linear
        in_features: 256
        out_features: 10
  optimizer:
    _target_: torch.optim.Adam
    _partial_: true
    lr: 0.001
  scheduler:
    _target_: torch.optim.lr_scheduler.StepLR
    _partial_: true
    step_size: 5
    gamma: 0.1
  num_classes: 10
  n_transfer_epochs: 2

data_module:
  _target_: src.basic_lvl3.CIFAR10DataModule
  data_dir: data/
  batch_size: 64
  num_workers: 8
  # transforms for imagenet
  train_transform:
    _target_: torchvision.transforms.Compose
    transforms:
      - _target_: torchvision.transforms.RandomHorizontalFlip
      - _target_: torchvision.transforms.RandomAffine
        degrees: 15
        translate: [0.1, 0.1]
        scale: [0.9, 1.1]
      - _target_: torchvision.transforms.ColorJitter
        brightness: 0.1
        contrast: 0.1
        saturation: 0.1
        hue: 0.1
      - _target_: torchvision.transforms.RandomResizedCrop
        size: 32
        scale: [0.9, 1.1]
        ratio: [0.9, 1.1]
      - _target_: torchvision.transforms.ToTensor
      - _target_: torchvision.transforms.Normalize
        mean: [0.485, 0.456, 0.406]
        std: [0.229, 0.224, 0.225]

  test_transform:
    _target_: torchvision.transforms.Compose
    transforms:
      - _target_: torchvision.transforms.ToTensor
      - _target_: torchvision.transforms.Normalize
        mean: [0.485, 0.456, 0.406]
        std: [0.229, 0.224, 0.225]

trainer:
  _target_: lightning.Trainer
  max_epochs: 10
  # fast_dev_run: true
  # limit_train_batches: 100
  # limit_val_batches: 100
  # limit_test_batches: 100
